# HWPX 문서 분리 및 합치기 도구 (HWPX Document Splitter and Merger Tool)

## 개요

이 프로그램은 한글과컴퓨터 오피스의 HWPX 또는 HWTX 형식 파일을 처리하기 위한 GUI 도구입니다. 주요 기능은 다음과 같습니다.

1.  **문서 분리:** 하나의 HWPX/HWTX 파일을 특정 텍스트(템플릿)가 포함된 페이지를 기준으로 여러 개의 파일로 분리합니다.
2.  **문서 합치기:** 특정 폴더에 있는 여러 개의 HWPX/HWTX 파일을 하나의 파일로 병합합니다.

이 도구는 PyQt5를 사용하여 사용자 인터페이스를 제공하며, 파일 처리 과정을 로그 창에 표시합니다.

## 주요 기능

* **분리하기:**
    * 지정한 HWPX/HWTX 입력 파일을 선택합니다.
    * 분리된 파일들을 저장할 출력 폴더를 지정합니다.
    * 문서 분리의 기준이 되는 텍스트 문자열(템플릿)을 설정합니다. (예: `[별지 제1호서식]`)
    * 문서 시작 부분에서 분리 기준을 적용하지 않고 건너뛸 페이지 수를 지정할 수 있습니다.
    * 템플릿이 포함된 페이지부터 새로운 문서 구간이 시작됩니다.
    * 원본 문서의 이미지, 표, 서식 등 구조를 유지하면서 내용만 분리하여 개별 HWPX 파일로 저장합니다.
* **합치기:**
    * 합칠 HWPX/HWTX 파일들이 들어있는 입력 폴더를 선택합니다.
    * 병합된 최종 파일을 저장할 출력 폴더를 지정합니다.
    * 입력 폴더 내의 모든 HWPX/HWTX 파일을 **알파벳 순서**로 정렬하여 순서대로 병합합니다.
    * 첫 번째 파일의 구조(스타일, 설정 등)를 기반으로 모든 파일의 페이지 내용을 합쳐 하나의 HWPX 파일(`merged.hwpx`)로 생성합니다.
* **사용자 인터페이스:**
    * PyQt5 기반의 탭 형식 GUI 제공 (분리하기 / 합치기).
    * 파일 및 폴더 선택을 위한 '찾아보기' 기능.
    * 처리 과정을 실시간으로 보여주는 로그 창.

## 요구 사항

* **Python 3:** 스크립트 실행 환경.
* **PyQt5:** GUI 라이브러리.

## 설치

1.  Python 3이 설치되어 있지 않다면 [python.org](https://www.python.org/)에서 다운로드하여 설치합니다.
2.  스크립트 실행에 필요한 PyQt5 라이브러리를 설치합니다. 터미널 또는 명령 프롬프트에서 다음 명령어를 실행하세요:
    ```bash
    pip install PyQt5
    ```

## 사용 방법

1.  스크립트 파일(`your_script_name.py`, 실제 파일명으로 변경)이 있는 디렉토리에서 터미널 또는 명령 프롬프트를 엽니다.
2.  다음 명령어로 프로그램을 실행합니다:
    ```bash
    python your_script_name.py
    ```
3.  GUI 창이 나타나면 원하는 작업에 따라 탭을 선택합니다.

### 분리하기 탭

1.  **입력 파일:** '파일 선택' 버튼을 클릭하여 분리할 HWPX 또는 HWTX 파일을 선택합니다.
2.  **출력 폴더:** '폴더 선택' 버튼을 클릭하여 분리된 파일들이 저장될 폴더를 선택하거나, 기본값('output\_sections')을 사용합니다.
3.  **분리 기준:** 문서에서 새로운 구간의 시작을 알리는 텍스트(예: 특정 서식 제목)를 입력합니다. 기본값은 `[별지 제7호서식]`입니다.
4.  **첫 페이지 무시 수:** 문서 시작 부분에서 분리 기준을 무시할 페이지 수를 설정합니다. 예를 들어 값이 3이면, 1~3 페이지는 분리 기준 검사를 하지 않고 4 페이지부터 검사를 시작합니다.
5.  '실행' 버튼을 클릭하면 분리 작업이 시작되고, 진행 상황이 아래 로그 창에 표시됩니다.
6.  작업이 완료되면 지정된 출력 폴더에 `section_1.hwpx`, `section_2.hwpx`, ... 와 같은 이름으로 파일이 생성됩니다.

### 합치기 탭

1.  **입력 폴더:** '폴더 선택' 버튼을 클릭하여 병합할 HWPX/HWTX 파일들이 들어있는 폴더를 선택합니다.
2.  **출력 폴더:** '폴더 선택' 버튼을 클릭하여 병합된 최종 파일이 저장될 폴더를 선택하거나, 기본값('merged\_output')을 사용합니다.
3.  '합치기 실행' 버튼을 클릭하면 병합 작업이 시작되고, 진행 상황이 아래 로그 창에 표시됩니다.
4.  작업이 완료되면 지정된 출력 폴더에 `merged.hwpx`라는 이름으로 병합된 파일이 생성됩니다.

## 작동 원리 (간략)

* HWPX/HWTX 파일은 본질적으로 ZIP 압축 파일입니다. 이 스크립트는 `zipfile` 모듈을 사용하여 HWPX 파일 내부의 XML 파일(주로 `Contents/section0.xml`)에 접근합니다.
* `xml.etree.ElementTree`를 사용하여 XML 구조를 파싱하고, 페이지 단위(스크립트에서는 `section0.xml` 루트 요소의 직계 자식 요소들을 페이지로 간주)로 내용을 처리합니다.
* **분리 시:** 각 페이지의 텍스트 내용을 검사하여 사용자가 지정한 `template` 문자열이 포함되어 있는지 확인하고, 이를 기준으로 페이지 목록을 나눕니다. 원본 HWPX 파일 구조를 복사한 후, `Contents/section0.xml`만 해당 구간의 페이지 내용으로 교체하여 새 HWPX 파일을 생성합니다.
* **합치기 시:** 지정된 폴더의 모든 HWPX 파일에서 `Contents/section0.xml` 내 페이지 요소들을 추출하여 순서대로 하나의 리스트로 만듭니다. 첫 번째 파일의 구조를 템플릿으로 사용하여, 모든 페이지 요소를 포함하는 새로운 `Contents/section0.xml`을 생성하고 이를 기반으로 병합된 HWPX 파일을 만듭니다.

## 주의사항

* 이 스크립트는 HWPX/HWTX 파일의 `Contents/section0.xml` 파일에 주 내용이 있다는 가정하에 작동합니다. 매우 복잡하거나 비표준적인 구조의 파일에서는 예상대로 작동하지 않을 수 있습니다.
* 분리 기능은 `section0.xml` 루트 요소의 직계 자식들을 '페이지'로 간주합니다. 파일 구조에 따라 이 가정이 맞지 않을 수 있습니다.
* 매우 큰 파일을 처리할 경우 시간이 오래 걸리거나 메모리 사용량이 많아질 수 있습니다.